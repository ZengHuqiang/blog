---
title: CAS乐观锁
date: 2020-05-13 13:38:25
tags: Java
categories: Java基础知识
urlname : CAS-Optimistic-lock
---

### 1.CAS简介

- 一种高效实现线程安全性的方法
- 支持源自更新操作，适用于计数器，序列发生器等场景
- 属于**乐观锁机制**，号称lock-free
- CAS操作失败时由开发者决定是继续尝试，还是执行别的操作

### **2.CAS思想**

- 包含三个操作数——内存位置V、预期原值A和新值B
- 当对共享变量进行操作时，将内存位置V赋给预期原值A，然后在A的基础上进行操作，最后将结果赋给新值B，**当且仅当预期值A和内存值V相同时，将内存值V修改为B，否则什么都不做（或者继续循环尝试）**

### 3.缺点

- 若循环时间长，则开销大
- 只能保证一个共享变量的原子操作
- ABA问题（当A被多次修改后还等于原来的值，CAS会认为A从来没有被改变过） 解决：AtomicStampedReference（控制变量值的版本来确定变量是否改变）